# Домашнее задание к занятию "3.6. Компьютерные сети, лекция 1"

1. Необязательное задание:
можно посмотреть целый фильм в консоли `telnet towel.blinkenlights.nl` :)

1. Узнайте о том, сколько действительно независимых (не пересекающихся) каналов есть в разделяемой среде WiFi при работе на 2.4 ГГц. Стандарты с полосой 5 ГГц более актуальны, но регламенты на 5 ГГц существенно различаются в разных странах, а так же не раз обновлялись. В качестве дополнительного вопроса вне зачета, попробуйте найти актуальный ответ и на этот вопрос.  
   Для wifi 2.4 ГГц определено 3 непересекающихся канала, всего же их 14. В стандарте 5 Ггц есть технически до 25 каналов, но, например в России разрещено только 17.
1. Адрес канального уровня – MAC адрес – это 6 байт, первые 3 из которых называются OUI – Organizationally Unique Identifier или уникальный идентификатор организации. Какому производителю принадлежит MAC `38:f9:d3:55:55:79`?  
Apple, Inc.

1. Каким будет payload TCP сегмента, если Ethernet MTU задан в 9001 байт, размер заголовков IPv4 – 20 байт, а TCP – 32 байта?  
9001-20-32=8949 байт

1. Может ли во флагах TCP одновременно быть установлены флаги SYN и FIN при штатном режиме работы сети? Почему да или нет?  
При штатной работе сети нет. Это означает одновременно конец и инициализацию соединения, что не является нормально работой и не разрешается протоколом TCP. 

1. `ss -ula sport = :53` на хосте имеет следующий вывод:

    ```bash
    State           Recv-Q          Send-Q                   Local Address:Port                     Peer Address:Port          Process
    UNCONN          0               0                        127.0.0.53%lo:domain                        0.0.0.0:*
    ```
   
   Почему в `State` присутствует только `UNCONN`, и может ли там присутствовать, например, `TIME-WAIT`?  
   Данная команда с флагом -u показывает UDP соединения. Time-wait как и в целом концепция соединения отсутствует в протоколе UDP. 
1. Обладая знаниями о том, как штатным образом завершается соединение (FIN от инициатора, FIN-ACK от ответчика, ACK от инициатора), опишите в каких состояниях будет находиться TCP соединение в каждый момент времени на клиенте и на сервере при завершении. Схема переходов состояния соединения вам в этом поможет.  
Сервер - инициатор завершения соединения - отправит FIN, и будет иметь состояние FIN WAIT 1. Клиент получит FIN, перешлет ACK, перейдет в состояние CLOSE WAIT. Сервер получит ACK, перейдет в состояние FIN WAIT 2. Клиент отправит FIN, перейдет в состояние LAST ACK. Сервер получит FIN, отправит ACK, перейдет в состояние TIME WAIT. Клиент получит ACK и соединение для него завершится. Когда пройдет TIME WAIT соединение завершится дл сервера.

1. TCP порт – 16 битное число. Предположим, 2 находящихся в одной сети хоста устанавливают между собой соединения. Каким будет теоретическое максимальное число соединений, ограниченное только лишь параметрами L4, которое параллельно может установить клиент с одного IP адреса к серверу с одним IP адресом? Сколько соединений сможет обслужить сервер от одного клиента? А если клиентов больше одного?  
Клиент теоретически открыть 65 536 подключений к одному порту сервера. Для сервера доступно 65 536 подключение на клиента на порт. Если клиентов больше одного, то лимит на каждого свой.
   
1. Может ли сложиться ситуация, при которой большое число соединений TCP на хосте находятся в состоянии  `TIME-WAIT`? Если да, то является ли она хорошей или плохой? Подкрепите свой ответ пояснением той или иной оценки.  
   Если происходит много соединений с клиентами, особенно короткоживущих, то такая ситуация может возникнуть. Эта ситуация плоха для сервера тем, что количество портов ограничено, может возникнуть дефицит ресурсов.

1. Чем особенно плоха фрагментация UDP относительно фрагментации TCP?  
При потере одного из фрагментов, т.е. ip пакета с частью UDP датаграммы, будет уничтожена вся полезная нагрузка датаграммы. В TCP же сегмент будет определен как недействительный и отправлен повторно.

1. Если бы вы строили систему удаленного сбора логов, то есть систему, в которой несколько хостов отправяют на центральный узел генерируемые приложениями логи (предположим, что логи – текстовая информация), какой протокол транспортного уровня вы выбрали бы и почему? Проверьте ваше предположение самостоятельно, узнав о стандартном протоколе syslog.  
   UDP, потому что логов достаточно много и они регулярно поступают. Т.е. с одной стороны они нужны оперативно, с другой стороны не так критично потерять часть данных. Syslog исходно использовал UDP, но для гарантиованной доставки была добавлена поддержка TCP в качестве транспорта. Для критически важных вещей действительно надежнее будет использовать TCP.

1. Сколько портов TCP находится в состоянии прослушивания на вашей виртуальной машине с Ubuntu, и каким процессам они принадлежат?
5 портов.
   ```bash   
   vagrant@vagrant:~$ sudo ss -p -l -t
   State  Recv-Q Send-Q Local Address:Port     Peer Address:Port Process
   LISTEN 0      4096         0.0.0.0:sunrpc        0.0.0.0:*     users:(("rpcbind",pid=601,fd=4),("systemd",pid=1,fd=35))
   LISTEN 0      4096   127.0.0.53%lo:domain        0.0.0.0:*     users:(("systemd-resolve",pid=602,fd=13))
   LISTEN 0      128          0.0.0.0:ssh           0.0.0.0:*     users:(("sshd",pid=1018,fd=3))
   LISTEN 0      4096            [::]:sunrpc           [::]:*     users:(("rpcbind",pid=601,fd=6),("systemd",pid=1,fd=37))
   LISTEN 0      128             [::]:ssh              [::]:*     users:(("sshd",pid=1018,fd=4))
   или
   vagrant@vagrant:~$ sudo lsof -i -s TCP:listen
   COMMAND    PID            USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
   systemd      1            root   35u  IPv4  16035      0t0  TCP *:sunrpc (LISTEN)
   systemd      1            root   37u  IPv6  16043      0t0  TCP *:sunrpc (LISTEN)
   rpcbind    601            _rpc    4u  IPv4  16035      0t0  TCP *:sunrpc (LISTEN)
   rpcbind    601            _rpc    6u  IPv6  16043      0t0  TCP *:sunrpc (LISTEN)
   systemd-r  602 systemd-resolve   13u  IPv4  21019      0t0  TCP localhost:domain (LISTEN)
   sshd      1018            root    3u  IPv4  25418      0t0  TCP *:ssh (LISTEN)
   sshd      1018            root    4u  IPv6  25430      0t0  TCP *:ssh (LISTEN)
   ```
1. Какой ключ нужно добавить в `tcpdump`, чтобы он начал выводить не только заголовки, но и содержимое фреймов в текстовом виде? А в текстовом и шестнадцатиричном?  
-A текстовый. -X hex + text, -XX hex, text, with link header
1. Попробуйте собрать дамп трафика с помощью `tcpdump` на основном интерфейсе вашей виртуальной машины и посмотреть его через tshark или Wireshark (можно ограничить число пакетов `-c 100`). Встретились ли вам какие-то установленные флаги Internet Protocol (не флаги TCP, а флаги IP)? Узнайте, какие флаги бывают. Как на самом деле называется стандарт Ethernet, фреймы которого попали в ваш дамп? Можно ли где-то в дампе увидеть OUI?  
Flags: 0x4000, Don't fragment  
Возможные флаги  
0... .... .... .... = Reserved bit: Not set  
.0.. .... .... .... = Don't fragment: Not set  
..0. .... .... .... = More fragments: Not set  
Они используются для контроля фрагментации.  
Проокол Ethernet II  
Во фрейме ethernet можно увидеть MAC адрес и соответственно OUI  
 Src: PcsCompu_14:86:db (08:00:27:14:86:db), Dst: RealtekU_12:35:02 (52:54:00:12:35:02)

 ---

### Как оформить ДЗ?

Домашнее задание выполните в файле readme.md в github репозитории. В личном кабинете отправьте на проверку ссылку на .md-файл в вашем репозитории.

Также вы можете выполнить задание в [Google Docs](https://docs.google.com/document/u/0/?tgif=d) и отправить в личном кабинете на проверку ссылку на ваш документ.
Название файла Google Docs должно содержать номер лекции и фамилию студента. Пример названия: "1.1. Введение в DevOps — Сусанна Алиева"
Перед тем как выслать ссылку, убедитесь, что ее содержимое не является приватным (открыто на комментирование всем, у кого есть ссылка). 
Если необходимо прикрепить дополнительные ссылки, просто добавьте их в свой Google Docs.

Любые вопросы по решению задач задавайте в чате Slack.

---
